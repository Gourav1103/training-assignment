[
    {
      "operation": "shift",
      "spec": {
        "person": {
          "$": "personkey",
          "*": {
            "@": "&1.val",
            "$": "&1.key"
          },
          "address": {
            "$": "addresskey",
            "*": {
              "@": "&1.val",
              "$": "&1.key"
            }
          }
        }
      }
    },
    {
      "operation": "modify-overwrite-beta",
      "spec": {
        "name": {
          "key": "=concat(@(2,personkey),'_',@(1,key))"
        },
        "age": {
          "key": "=concat(@(2,personkey),'_',@(1,key))"
        },
        "city": {
          "key": "=concat(@(2,personkey),'_',@(2,addresskey),'_',@(1,key))"
        },
        "state": {
          "key": "=concat(@(2,personkey),'_',@(2,addresskey),'_',@(1,key))"
        }
      }
    },
    {
      "operation": "shift",
      "spec": {
        "*": {
          "@(val)": "@(1,key)"
        }
      }
    }
  ]